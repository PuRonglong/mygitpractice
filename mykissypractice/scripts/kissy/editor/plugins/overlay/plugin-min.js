KISSY.Editor.add("overlay/focus",function(){function b(){}var d=KISSY,c=d.UA,e=d.Editor,f=e.focusManager;e.namespace("UIBase");e.UIBase.Focus?d.log("ke uibase focus attach more","warn"):(b.ATTRS={focus4e:{value:!0}},b.prototype={_uiSetFocus4e:function(a){a?(this.on("show",this._show4FocusExt,this),this.on("hide",this._hide4FocusExt,this)):(this.detach("show",this._show4FocusExt,this),this.detach("hide",this._hide4FocusExt,this))},__syncUI:function(){},__renderUI:function(){},__bindUI:function(){this._focus4e=
(new d.Node("<a href='#' class='ke-focus' style='width:0;height:0;margin:0;padding:0;overflow:hidden;outline:none;font-size:0;'></a>")).appendTo(this.get("el"))},_show4FocusExt:function(){var a=this._focusEditor=f.currentInstance();if(c.ie&&a){window.focus();document.body.focus();this._focus4e[0].focus();var b=a.document.selection.createRange();b&&b.item&&b.item(0).ownerDocument==a.document&&(a=document.body.createTextRange(),a.moveToElementText(this.get("el")._4e_first()[0]),a.collapse(!0),a.select())}},
_hide4FocusExt:function(){var a=this._focusEditor;a&&a.focus()}},e.UIBase.Focus=b)},{attach:!1});
KISSY.Editor.add("overlay",function(){var b=KISSY,d=b.require("uibase"),c=b.Editor;if(c.Overlay)b.log("ke overlay attach more");else{b.use("overlay");var e=d.create(b.require("overlay"),[c.UIBase.Focus],{syncUI:function(){c.Utils.preventFocus(this.get("contentEl"))}},{ATTRS:{zIndex:{value:c.baseZIndex(c.zIndexManager.OVERLAY)}}}),f=d.create(b.require("overlay").Dialog,[c.UIBase.Focus],{show:function(){this.center();var a=this.get("y");200<a-b.DOM.scrollTop()&&(a=b.DOM.scrollTop()+200,this.set("y",
a));f.superclass.show.call(this)}},{ATTRS:{constrain:{value:!0},zIndex:{value:c.baseZIndex(c.zIndexManager.OVERLAY)}}});c.Overlay=e;c.Dialog=f;var a;c.Overlay.loading=function(){a||(a=new c.Overlay({x:0,focus4e:!1,width:6==b.UA.ie?b.DOM.docWidth():"100%",y:0,zIndex:c.baseZIndex(c.zIndexManager.LOADING),elCls:"ke-global-loading"}));a.set("height",b.DOM.docHeight());a.show();a.loading()};c.Overlay.unloading=function(){a&&a.hide()}}},{requires:["overlay/focus"]});
