KISSY.Editor.add("localstorage",function(){var d=KISSY,a=d.Editor;if(a.storeReady)d.log("localstorage attach more","warn");else if(a.storeReady=function(b){a.on("storeReady",b)},a.on("storeReady",function(){a.storeReady=function(b){b()};a.detach("storeReady")}),!d.UA.ie&&window.localStorage)a.localStorage=window.localStorage,a.fire("storeReady");else{var e=a.Utils.debugUrl("localstorage/swfstore.swf?t="+ +new Date),c=new a.FlashBridge({movie:e,flashVars:{useCompression:!0},methods:["setItem","removeItem",
"getItem","setMinDiskSpace","getValueOf"]});d.use("overlay",function(){c.swf.height=138;var b=new (d.require("overlay"))({headerContent:"\u8bf7\u70b9\u5141\u8bb8",width:"0px",elStyle:{overflow:"hidden"},content:"<h1 style='border:1px solid black;border-bottom:none;background:white;text-align:center;'>\u8bf7\u70b9\u51fb\u5141\u8bb8</h1>",zIndex:a.baseZIndex(a.zIndexManager.STORE_FLASH_SHOW)});b.render();b.get("contentEl").append(c.swf);b.center();b.show();c.on("pending",function(){b.set("width",215);b.center();b.show();setTimeout(function(){c.retrySave()},
1E3)});c.on("save",function(){b.set("width",0)})});var f=c.setItem;d.mix(c,{_ke:1,getItem:function(b){return this.getValueOf(b)},retrySave:function(){this.setItem(this.lastSave.k,this.lastSave.v)},setItem:function(b,a){this.lastSave={k:b,v:a};f.call(this,b,a)}});c.on("contentReady",function(){a.localStorage=c;a.fire("storeReady")})}},{attach:!1,requires:["flashutils","flashbridge"]});
