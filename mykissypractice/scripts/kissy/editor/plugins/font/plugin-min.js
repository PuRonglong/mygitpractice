KISSY.Editor.add("font",function(b){b.addPlugin("font",function(){function s(c){for(var a=[],b=0;b<c.length;b++)a.push({name:c[b],value:c[b]});return a}var g=KISSY,f=g.Editor,m=f.Style,n=f.TripleButton,d=b.cfg.pluginConfig,h=d["font-size"],a,l,i,j=[];if(!1!==h){h=h||{};g.mix(h,{items:s("8px,10px,12px,14px,18px,24px,36px,48px,60px,72px,84px,96px".split(",")),width:"55px"},!1);for(var o={},p=[],e={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]},k=0;k<
h.items.length;k++)a=h.items[k],l=a.name,i=a.attrs,a=a.value,o[a]=new m(e,{size:a}),p.push({name:l,value:a,attrs:i});d["font-size"]=h}e=d["font-family"];if(!1!==e){e=e||{};g.mix(e,{items:[{name:"\u5b8b\u4f53",value:"SimSun"},{name:"\u9ed1\u4f53",value:"SimHei"},{name:"\u96b6\u4e66",value:"LiSu"},{name:"\u6977\u4f53",value:"KaiTi_GB2312"},{name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft YaHei"},{name:"Georgia",value:"Georgia"},{name:"Times New Roman",value:"Times New Roman"},{name:"Impact",value:"Impact"},{name:"Courier New",value:"Courier New"},{name:"Arial",
value:"Arial"},{name:"Verdana",value:"Verdana"},{name:"Tahoma",value:"Tahoma"}],width:"130px"},!1);var q={},r=[],t={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},k;d["font-family"]=e;for(k=0;k<e.items.length;k++)a=e.items[k],l=a.name,i=a.attrs||{},a=a.value,i.style=i.style||"",i.style+=";font-family:"+a,q[a]=new m(t,{family:a}),r.push({name:l,value:a,attrs:i})}l={click:function(c){var a=c.newVal,c=c.prevVal,d=this.cfg.styles;b.focus();b.fire("save");
d=d[a];a==c?d.remove(b.document):d.apply(b.document);b.fire("save")},selectionChange:function(c){for(var c=c.path.elements,a=this.cfg.styles,b=0,d;b<c.length;b++){d=c[b];for(var e in a)if(a.hasOwnProperty(e)&&a[e].checkElementRemovable(d,!0)){this.btn.set("value",e);return}}(e=this.cfg.defaultValue)?this.btn.set("value",e):this.btn.reset("value")}};!1!==d["font-size"]&&j.push(b.addSelect("font-size",g.mix({title:"\u5927\u5c0f",width:"30px",mode:f.WYSIWYG_MODE,showValue:!0,defaultValue:h.defaultValue,popUpWidth:h.width,
items:p,styles:o},l)));!1!==d["font-family"]&&j.push(b.addSelect("font-family",g.mix({title:"\u5b57\u4f53",width:"110px",mode:f.WYSIWYG_MODE,defaultValue:e.defaultValue,popUpWidth:e.width,items:r,styles:q},l)));f={mode:f.WYSIWYG_MODE,offClick:function(){var c=this.editor,a=this.cfg.style;c.fire("save");a.apply(c.document);c.fire("save");c.notifySelectionChange();c.focus()},onClick:function(){var c=this.editor,a=this.cfg.style;c.fire("save");a.remove(c.document);c.fire("save");c.notifySelectionChange();c.focus()},
selectionChange:function(a){var b=this.btn;this.cfg.style.checkActive(a.path)?b.set("state",n.ON):b.set("state",n.OFF)}};!1!==d["font-bold"]&&j.push(b.addButton("font-bold",g.mix({contentCls:"ke-toolbar-bold",title:"\u7c97\u4f53 ",style:new m({element:"strong",overrides:[{element:"b"},{element:"span",attributes:{style:"font-weight: bold;"}}]})},f)));!1!==d["font-italic"]&&j.push(b.addButton("font-italic",g.mix({contentCls:"ke-toolbar-italic",title:"\u659c\u4f53 ",style:new m({element:"em",overrides:[{element:"i"},{element:"span",
attributes:{style:"font-style: italic;"}}]})},f)));!1!==d["font-underline"]&&j.push(b.addButton("font-underline",g.mix({contentCls:"ke-toolbar-underline",title:"\u4e0b\u5212\u7ebf ",style:new m({element:"u",overrides:[{element:"span",attributes:{style:"text-decoration: underline;"}}]})},f)));!1!==d["font-strikeThrough"]&&j.push(b.addButton("font-underline",g.mix({contentCls:"ke-toolbar-strikeThrough",title:"\u5220\u9664\u7ebf ",style:new m((d["font-strikeThrough"]||{}).style||{element:"del",overrides:[{element:"span",attributes:{style:"text-decoration: line-through;"}},
{element:"s"},{element:"strike"}]})},f)));this.destroy=function(){for(var a=0;a<j.length;a++)j[a].destroy()}})},{attach:!1});
