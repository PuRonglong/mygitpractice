KISSY.Editor.add("button",function(){function l(a){if(a&&a.indexOf("<")==-1)return a;return 0}var g=KISSY,h=g.Editor,k=g.require("uibase");if(h.TripleButton)g.log("TripleButton attach twice","warn");else{var d=k.create([k.Box.Render||k.Box],{_updateHref:function(){this.get("el").attr("href","javascript:void('"+(l(this.get("text"))||l(this.get("title")))+"')")},bindUI:function(){var a=this,b=a.get("el");b.on("click",a._action,a);b.on("mousedown",function(){a.get("state")=="off"&&b.addClass("ke-triplebutton-active")});
b.on("mouseup mouseleave",function(){a.get("state")=="off"&&b.hasClass("ke-triplebutton-active")&&setTimeout(function(){b.removeClass("ke-triplebutton-active")},300)})},_uiSetTitle:function(){this.get("el").attr("title",this.get("title"));this._updateHref()},_uiSetContentCls:function(a){var b=this.get("el");if(a!==undefined){b.html("<span class='ke-toolbar-item "+a+"' />");b._4e_unselectable()}},_uiSetText:function(a){this.get("el").html(a);this._updateHref()},_uiSetState:function(a){this["_"+a]()},
disable:function(){this._savedState=this.get("state");this.set("state","disabled")},enable:function(){this.get("state")=="disabled"&&this.set("state",this._savedState)},_action:function(a){this.fire(this.get("state")+"Click",{TripleEvent:a});this.fire("click",{TripleClickType:this.get("state")+"Click"});a&&a.preventDefault()},bon:function(){this.set("state","on")},boff:function(){this.set("state","off")},_on:function(){var a=this.get("el");a.removeClass("ke-triplebutton-off ke-triplebutton-disabled");
a.addClass("ke-triplebutton-on")},_off:function(){var a=this.get("el");a.removeClass("ke-triplebutton-on ke-triplebutton-disabled");a.addClass("ke-triplebutton-off")},_disabled:function(){var a=this.get("el");a.removeClass("ke-triplebutton-off ke-triplebutton-on");a.addClass("ke-triplebutton-disabled")}},{ATTRS:{state:{value:"off"},elCls:{value:"ke-triplebutton ke-triplebutton-off"},elTagName:{value:"a"},title:{},contentCls:{},text:{}}});d.ON="on";d.OFF="off";d.DISABLED="disabled";d.ON_CLASS="ke-triplebutton-on";
d.OFF_CLASS="ke-triplebutton-off";d.DISABLED_CLASS="ke-triplebutton-disabled";h.TripleButton=d;h.prototype.addButton=function(a,b){var f=this,c=new d({render:f.toolBarDiv,autoRender:true,title:b.title,text:b.text,contentCls:b.contentCls}),e={name:a,btn:c,editor:f,cfg:b,call:function(){var j=g.makeArray(arguments),i=j.shift();return b[i].apply(e,j)},reload:function(j){g.mix(b,j);c.enable();f.on("selectionChange",function(){f.getMode()!=h.SOURCE_MODE&&b.selectionChange&&b.selectionChange.apply(e,arguments)});
c.on("click",function(i){var m=i.TripleClickType;b[m]&&b[m].apply(e,arguments);i&&i.halt()});if(b.mode==h.WYSIWYG_MODE){f.on("wysiwygmode",c.enable,c);f.on("sourcemode",c.disable,c)}b.init&&b.init.call(e)},destroy:function(){b.destroy&&b.destroy.call(e);c.destroy()}};b.loading?c.disable():e.reload(undefined);return e}}},{attach:false});
